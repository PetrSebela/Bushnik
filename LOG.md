# Logs

## 25.9.2025 Basic airplane mode
![Bushplane model](/Image/Airplane.png)
- Basic airplane model inspired by Piper PA-18 Super Cub

## 8.10.2025 LOD system
![LOD system Visualization](/Image/LOD.png)
- Layed out rought sketch of terrain system
- Mesh is computed on the GPU (terrain heightmap + mesh triangles)
- Started using [NoiseShader](https://github.com/keijiro/NoiseShader?tab=readme-ov-file) library for noise generation on GPU

## 9.10.2025 Heightmap preview
![Heightmap preview](/Image/Heightmap.png)
- Custom editor window for previewing heightmaps generated by compute shaders
- Basic noise layering and masking

## 24.10.2025 Terrain heightmaps
### Falloff map
The desired island shape is achived by using "falloff" map. This is done by using subtracting value from the terrain sample based on its distance from the center of the island. 

This would normally be described by this equation derived from the analytic equation for circle $$\sqrt{x^2-y^2}$$

By using this function we can achieve the desired look, however the result leaves lot of space in the corners and looks rather circular (duh). This can be fixe by using equation for so called squicle. 
$$ | \frac{x^4}{r_x} | + | \frac{y^4}{r_y} |$$

By using this equation we get this result.

![Squircle](/Image/Squircle.png)

### Noise
#### Fractal Brownian Motion
Constructed from multiple layers of noise

Creates large features and fine detail

| Heightmap                          | Render |
|------------------------------------|--------|
| ![Heightmap](/Image/FBM-plain.png) | ![Render](/Image/FBM-plain-render.png) 

#### Domain warping
Each sample is offseted by value sampled from another noise function

Created ridge-like features

| Heightmap                  | Render |
|----------------------------|--------|
| ![Heightmap](/Image/FBM-warped.png) | ![Render](/Image/FBM-warped-render.png) 

#### Distribution change
Remapping the values from "linear" function to "exponential" one, we can achive wider valleys and steeper mountains

| Heightmap                          | Render |
|------------------------------------|--------|
| ![Heightmap](/Image/FBM-warped-squered.png) | ![Render](/Image/FBM-warped-squared-render.png) 

#### Creese
So far, the noise function was normalized to that is was in the range (0, 1). The original noise function has values in the range (-1, 1). By taking the absolute value of said function, we can achieve ridges similar to domain-warping technique.

| Heightmap               | Render |
|-------------------------|--------|
| ![Heightmap](/Image/FBM-abs.png) | ![Render](/Image/FBM-abs-render.png) 

#### Combined
All the techniques above mashed into one.

| Heightmap                    | Render |
|------------------------------|--------|
| ![Heightmap](/Image/FBM-combined.png) | ![Render](/Image/FBM-combined-render.png) 

#### Future
Combine multple terrain functions based on biomes inside the terrain.

## 2.11.2025 Automatic billboard generation from 3D models
If we want to populate the terrain with any substatial amount of foliage, we will need to reduce the amount of triangles that need to be rendered. 
To do so, we utilize so billbaords. Single billboard consists consist of two perpendicular planes that display image of represented object. 
Using this we can have good enough approximation of original full resolution model with just 4 triangles.

| Original                                          | Billboard                                 |
|---------------------------------------------------|-------------------------------------------|
| ![Original model](/Image/Billboards/Original.png) | ![Billboard model](/Image/Billboards/Billboard.png) 


To properly scale the final billboard we first need to find the longest side of the AABB that is centered at models origin.
Then we can just set the camera size, rotate it around the model in incrementing steps and render individual textures for billboard.

![AABBs](/Image/Billboards/AABB.png) 

The final textures are converted into array that is indexed inside shader that is responsible for rendering of the billboard. 
To determine which texture should be assigned each plane, we encode the array indices into the mesh UV channel.

## 8.11.2025 Instancing
To render large amount of trees into we need to use mesh instancing to save drawcalls. 
Terrain is subdiveded into chunks that are responsible for managment of individual instances. 
By using chunks we can achive more granular control over which models should be rendered as billboards or their full resolution model.

| ![Original model](/Image/LODs/Highground.png) | ![Billboard model](/Image/LODs/Valley.png) 
|-----------------------------------------------|-------------------------------------------|

So far, the game manages to render $50Km^2$ map between 30 - 40 FPS. 
At this moment the game renders all trees are rendered at once, so in the future they will need to be culled.